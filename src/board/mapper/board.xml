<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="board">
	<select id="boardCount" resultType="int">
		SELECT count(*) FROM project_jsp_board
	</select>
	<select id="list" resultType="board.dto.BoardDTO">
		 SELECT *
			FROM (
 		 	select A.*, rownum as rn 
			from (
      			select num,writer,subject,reg_date,readcount,filename,filesize,down,show
			,(select count(*) from project_jsp_comment where board_num=c_num) comment_count
      				from project_jsp_board
      				order by num DESC
  				) A
			)
		where rn between #{start} and #{end}
	</select>
	<insert id="write">
		INSERT INTO project_jsp_board
			(num,writer,subject,content,ip,filename,filesize,show)  
			VALUES 
			( (select nvl(max(num)+1,1) from project_jsp_board) 
 			 , #{writer},#{subject}
 			 , #{content},#{ip},#{filename},#{filesize},#{show}) 
	</insert>
</mapper>

